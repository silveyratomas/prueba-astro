---
import Layout from "../layouts/Layout.astro";
import { products } from "../data/products";
const fmt = (c: number) => '$ ' + (c).toFixed(2);
---

<Layout title="Listado (box)">
  <h1 class="text-2xl font-bold mb-4 text-[var(--text)]">Productos (box)</h1>
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
    {products.map(p => (
      <article class="bg-[var(--card)] border border-[var(--card-border)] rounded-xl shadow-sm p-4 flex flex-col">
        <!-- wrapper 16:9 + object-contain (NO recorta) -->
        <div class="relative w-full overflow-hidden rounded-lg bg-[var(--surface)]" style="padding-top:56.25%;">
          <img
            src={p.img}
            alt={p.title}
            class="absolute inset-0 w-full h-full object-contain"
            loading="lazy"
          />
        </div>

        <h3 class="mt-3 text-lg font-semibold text-[var(--text)]">{p.title}</h3>
        <p class="text-[var(--muted)]">{fmt(p.price)}</p>
        <p class="text-sm text-[var(--muted)] mb-3">{p.description}</p>

        <div class="mt-auto flex gap-2">
          <a class="inline-flex items-center rounded-lg bg-[var(--accent)] text-white px-4 py-2 hover:bg-[var(--accent)]/80"
             href={`/producto/${p.slug}`}>Ver</a>
          <button class="inline-flex items-center rounded-lg bg-[var(--accent)] text-white px-4 py-2 hover:bg-[var(--accent)]/80"
            onclick={`tpCart.addToCart(${JSON.stringify({ slug:p.slug, title:p.title, price:p.price, qty:1 })})`}>
            Agregar
          </button>
        </div>
      </article>
    ))}
  </div>
</Layout>
